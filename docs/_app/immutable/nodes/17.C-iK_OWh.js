import{f as h,a as e,c as T,t as i}from"../chunks/DnKRhqIz.js";import{p as Q,q as j,k as t,v as q,a as V,c as y,f,n as B,s as g,r as D,t as X}from"../chunks/C_6UiiDj.js";import{i as b,s as Z}from"../chunks/BiKsXKFa.js";import{c as $}from"../chunks/Dx7iaVqR.js";import{b as k}from"../chunks/CnOpXMm8.js";import{g as ee}from"../chunks/DSdwtwDU.js";import{p as re}from"../chunks/7_CIfT-0.js";import{e as I}from"../chunks/DSNh7Njp.js";import{L as ae}from"../chunks/B2N5e1u8.js";import{B as K}from"../chunks/DTP4muSX.js";import{C as te}from"../chunks/8U42_7tY.js";import{C as se,a as oe,b as ne}from"../chunks/CRNYLTrB.js";var ie=h('<p>You already have data here. Would you like to overwrite it?</p> <div class="flex gap-2"><!> <!></div>',1),le=h("<p><!></p> <!>",1),de=h("<!> <!>",1),fe=h('<div class="flex min-h-screen min-w-screen items-center justify-center"><!></div>');function Le(Y,z){Q(z,!0);let s=q(void 0),O=q(!1);j(O,localStorage.getItem(ae.token)!==null),j(s,re.url.searchParams.get("origin"),!0),t(O)||w();function w(){if(I.PUBLIC_ALLOWED_MIGRATION_ORIGINS===void 0)return;const L=I.PUBLIC_ALLOWED_MIGRATION_ORIGINS.split(",");opener!==null&&t(s)!==null&&t(s)!==void 0&&(opener.postMessage("ready",t(s)),addEventListener("message",({origin:c,data:m,source:U})=>{!L.includes(c)||!(m instanceof Map)||(m.forEach((u,v)=>localStorage.setItem(v,u)),U?.postMessage("success",{targetOrigin:c}),ee(k+k+"/grades"))}))}var x=fe(),F=y(x);$(F,()=>te,(L,c)=>{c(L,{children:(m,U)=>{var u=de(),v=f(u);$(v,()=>se,(C,M)=>{M(C,{children:(P,J)=>{var l=T(),d=f(l);$(d,()=>oe,(A,G)=>{G(A,{children:(N,W)=>{B();var R=i("Migrate User Data");e(N,R)},$$slots:{default:!0}})}),e(P,l)},$$slots:{default:!0}})});var H=g(v,2);$(H,()=>ne,(C,M)=>{M(C,{class:"space-y-4",children:(P,J)=>{var l=le(),d=f(l),A=y(d);{var G=r=>{var o=T(),p=f(o);{var _=a=>{var n=i();X(()=>Z(n,`Migrating user data from ${t(s)??""}...`)),e(a,n)},E=a=>{var n=i("Cannot migrate user data: source origin unspecified");e(a,n)};b(p,a=>{t(s)!==null?a(_):a(E,!1)})}e(r,o)},N=r=>{var o=i("Cannot migrate user data: no migration origins allowed");e(r,o)};b(A,r=>{I.PUBLIC_ALLOWED_MIGRATION_ORIGINS!==void 0?r(G):r(N,!1)})}D(d);var W=g(d,2);{var R=r=>{var o=ie(),p=g(f(o),2),_=y(p);K(_,{get href(){return`${k??""}/grades`},variant:"outline",class:"flex-1",children:(a,n)=>{B();var S=i("Cancel");e(a,S)},$$slots:{default:!0}});var E=g(_,2);K(E,{onclick:w,variant:"destructive",class:"flex-1 cursor-pointer",children:(a,n)=>{B();var S=i("Overwrite");e(a,S)},$$slots:{default:!0}}),D(p),e(r,o)};b(W,r=>{I.PUBLIC_ALLOWED_MIGRATION_ORIGINS!==void 0&&t(s)!==null&&t(O)&&r(R)})}e(P,l)},$$slots:{default:!0}})}),e(m,u)},$$slots:{default:!0}})}),D(x),e(Y,x),V()}export{Le as component};
